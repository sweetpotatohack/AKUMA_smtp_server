#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–§–µ–Ω—è's –§–ò–ù–ê–õ–¨–ù–´–ô –ø–∞—Ç—á –¥–ª—è DNS –∑–∞–ø–∏—Å–µ–π
–ó–∞–º–µ–Ω—è–µ–º –í–°–Æ —Å–µ–∫—Ü–∏—é DNS –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é!
"""

import re

def main():
    with open('smtp_ultimate_deploy.sh', 'r', encoding='utf-8') as f:
        content = f.read()
    
    # –ù–æ–≤–∞—è —Å–µ–∫—Ü–∏—è DNS –∑–∞–ø–∏—Å–µ–π —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏
    new_dns_section = '''
================================================================================
üî• –û–°–ù–û–í–ù–´–ï –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –ó–ê–ü–ò–°–ò (–ë–ï–ó –ù–ò–• –ù–ò–ß–ï–ì–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢!)
================================================================================

1. üìç A-–ó–ê–ü–ò–°–¨ (–°–≤—è–∑—ã–≤–∞–µ—Ç –ø–æ–¥–¥–æ–º–µ–Ω mail —Å IP)
   –¢–∏–ø: A
   –ò–º—è: mail (–ø–æ–¥–¥–æ–º–µ–Ω –¥–ª—è $DOMAIN)
   –ü–æ–ª–Ω–æ–µ –∏–º—è: mail.$DOMAIN
   –ó–Ω–∞—á–µ–Ω–∏–µ: $SERVER_IP
   TTL: 3600 (1 —á–∞—Å)

2. üìß MX-–ó–ê–ü–ò–°–¨ (–£–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—á—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä)
   –¢–∏–ø: MX
   –ò–º—è: @ (–∏–ª–∏ –ø—É—Å—Ç–æ–µ –¥–ª—è –∫–æ—Ä–Ω–µ–≤–æ–≥–æ –¥–æ–º–µ–Ω–∞ $DOMAIN)
   –ó–Ω–∞—á–µ–Ω–∏–µ: 10 mail.$DOMAIN
   –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 10
   TTL: 3600

================================================================================
üõ°Ô∏è –ó–ê–©–ò–¢–ù–´–ï –ó–ê–ü–ò–°–ò (SPF, DKIM, DMARC) - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´ –î–õ–Ø –î–û–°–¢–ê–í–õ–Ø–ï–ú–û–°–¢–ò!
================================================================================

3. üõ°Ô∏è SPF-–ó–ê–ü–ò–°–¨ (–ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è)
   –¢–∏–ø: TXT
   –ò–º—è: @ (–∏–ª–∏ –ø—É—Å—Ç–æ–µ –¥–ª—è –∫–æ—Ä–Ω–µ–≤–æ–≥–æ –¥–æ–º–µ–Ω–∞ $DOMAIN)
   –ü–æ–ª–Ω–æ–µ –∏–º—è: $DOMAIN
   –ó–Ω–∞—á–µ–Ω–∏–µ: v=spf1 mx a:mail.$DOMAIN ~all
   TTL: 3600

4. üîê DKIM-–ó–ê–ü–ò–°–¨ (–¶–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å –ø–∏—Å–µ–º)
   –¢–∏–ø: TXT
   –ò–º—è: default._domainkey
   –ü–æ–ª–Ω–æ–µ –∏–º—è: default._domainkey.$DOMAIN
   –ó–Ω–∞—á–µ–Ω–∏–µ: $DKIM_RECORD
   TTL: 3600

5. üìä DMARC-–ó–ê–ü–ò–°–¨ (–ü–æ–ª–∏—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ–ø—Ä–æ—à–µ–¥—à–∏—Ö –ø—Ä–æ–≤–µ—Ä–∫—É –ø–∏—Å–µ–º)
   –¢–∏–ø: TXT
   –ò–º—è: _dmarc
   –ü–æ–ª–Ω–æ–µ –∏–º—è: _dmarc.$DOMAIN
   –ó–Ω–∞—á–µ–Ω–∏–µ: v=DMARC1; p=quarantine; rua=mailto:dmarc@$DOMAIN; ruf=mailto:dmarc@$DOMAIN; sp=quarantine; adkim=r; aspf=r
   TTL: 3600

================================================================================
üöÄ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –£–î–û–ë–ù–´–ï –ê–õ–ò–ê–°–´ (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û, –ù–û –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
================================================================================

6. üåê CNAME –¥–ª—è SMTP (–£–¥–æ–±—Å—Ç–≤–æ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤)
   –¢–∏–ø: CNAME
   –ò–º—è: smtp
   –ü–æ–ª–Ω–æ–µ –∏–º—è: smtp.$DOMAIN
   –ó–Ω–∞—á–µ–Ω–∏–µ: mail.$DOMAIN
   TTL: 3600

7. üì© CNAME –¥–ª—è IMAP (–£–¥–æ–±—Å—Ç–≤–æ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤)
   –¢–∏–ø: CNAME
   –ò–º—è: imap
   –ü–æ–ª–Ω–æ–µ –∏–º—è: imap.$DOMAIN
   –ó–Ω–∞—á–µ–Ω–∏–µ: mail.$DOMAIN
   TTL: 3600

8. üì§ CNAME –¥–ª—è POP3 (–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ POP3)
   –¢–∏–ø: CNAME
   –ò–º—è: pop3
   –ü–æ–ª–Ω–æ–µ –∏–º—è: pop3.$DOMAIN
   –ó–Ω–∞—á–µ–Ω–∏–µ: mail.$DOMAIN
   TTL: 3600

9. üíª CNAME –¥–ª—è –≤–µ–±-–ø–æ—á—Ç—ã (–ï—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ)
   –¢–∏–ø: CNAME
   –ò–º—è: webmail
   –ü–æ–ª–Ω–æ–µ –∏–º—è: webmail.$DOMAIN
   –ó–Ω–∞—á–µ–Ω–∏–µ: mail.$DOMAIN
   TTL: 3600

================================================================================
‚ö° PTR-–ó–ê–ü–ò–°–¨ (–û–ë–†–ê–¢–ù–´–ô DNS) - –ö–†–ò–¢–ò–ß–ù–û –î–õ–Ø –†–ï–ü–£–¢–ê–¶–ò–ò!
================================================================================

10. üîÑ PTR-–ó–ê–ü–ò–°–¨ (–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —É —Ö–æ—Å—Ç–∏–Ω–≥-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞!)
    IP: $SERVER_IP
    PTR: mail.$DOMAIN
    
    ‚ö†Ô∏è  –í–ê–ñ–ù–û: –≠—Ç–∞ –∑–∞–ø–∏—Å—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –Ω–µ –≤ –≤–∞—à–µ–π DNS –∑–æ–Ω–µ, –∞ —É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞!
    –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Å–≤–æ–µ–º—É —Ö–æ—Å—Ç–∏–Ω–≥-–ø—Ä–æ–≤–∞–π–¥–µ—Ä—É —Å –ø—Ä–æ—Å—å–±–æ–π –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å PTR –∑–∞–ø–∏—Å—å!

================================================================================
üí° –ü–†–ò–ú–ï–† –î–õ–Ø –î–û–ú–ï–ù–ê example.com (–ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –í–ê–® –î–û–ú–ï–ù):
================================================================================
A      mail.example.com                IN A     YOUR_SERVER_IP
MX     example.com                     IN MX    10 mail.example.com  
TXT    example.com                     IN TXT   "v=spf1 mx a:mail.example.com ~all"
TXT    default._domainkey.example.com  IN TXT   "v=DKIM1; k=rsa; p=YOUR_DKIM_KEY..."
TXT    _dmarc.example.com              IN TXT   "v=DMARC1; p=quarantine; rua=mailto:dmarc@example.com"
CNAME  smtp.example.com                IN CNAME mail.example.com
CNAME  imap.example.com                IN CNAME mail.example.com
'''
    
    # –ó–∞–º–µ–Ω—è–µ–º –≤—Å—é —Å–µ–∫—Ü–∏—é DNS –∑–∞–ø–∏—Å–µ–π
    # –ò—â–µ–º –Ω–∞—á–∞–ª–æ —Å–µ–∫—Ü–∏–∏ DNS
    start_pattern = r'================================================================================\nüî• –û–°–ù–û–í–ù–´–ï –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –ó–ê–ü–ò–°–ò.*?\n================================================================================.*?'
    
    # –ò—â–µ–º –∫–æ–Ω–µ—Ü —Å–µ–∫—Ü–∏–∏ (–¥–æ —Å–ª–µ–¥—É—é—â–µ–π –±–æ–ª—å—à–æ–π —Å–µ–∫—Ü–∏–∏)
    end_pattern = r'================================================================================\nüß™ –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò DNS –ó–ê–ü–ò–°–ï–ô'
    
    # –ù–∞—Ö–æ–¥–∏–º –≤—Å—é —Å–µ–∫—Ü–∏—é DNS –∑–∞–ø–∏—Å–µ–π
    dns_pattern = start_pattern + r'(.*?)' + end_pattern
    
    # –ó–∞–º–µ–Ω—è–µ–º –Ω–∞ –Ω–æ–≤—É—é —Å–µ–∫—Ü–∏—é
    replacement = new_dns_section + '\n================================================================================\nüß™ –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò DNS –ó–ê–ü–ò–°–ï–ô'
    
    content = re.sub(dns_pattern, replacement, content, flags=re.DOTALL)
    
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ
    with open('smtp_ultimate_deploy.sh', 'w', encoding='utf-8') as f:
        f.write(content)
    
    print("üéâ –í–°–Å –ò–°–ü–†–ê–í–õ–ï–ù–û!")
    print("‚úÖ DNS –∑–∞–ø–∏—Å–∏ —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–Ω—ã–µ –¥–æ–º–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞!")
    print("‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏!")
    print("‚úÖ –¢–µ–ø–µ—Ä—å –Ω–∏–∫—Ç–æ –Ω–µ –∑–∞–ø—É—Ç–∞–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ DNS!")

if __name__ == "__main__":
    main()
